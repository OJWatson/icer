<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infection composition estimation • icer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Infection composition estimation">
<meta property="og:description" content="Maximum likelihood estimator for the occurence
  of mixed infections given data on mixed infections.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">icer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="icer" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#icer" class="anchor"></a>icer</h1></div>

<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h2>
<p><code>icer</code> was designed to assess for interference between <em>Plasmodium</em> species to see if some species appeared in infections more often than expected under the assumption of independent random infection events, i.e. one species type is introduced from one infectious bite.</p>
<p><code>icer</code> works out the most likely population frequency of each species and the most likely number of infection types in individual by comparison to the observed data. These are then used to test if our data can be explained by this distribution by comparing the observed data to the bootstrapped samples from the resultant multinomial distribution describing the probability of being infected with each infection compositon type.</p>
<p>The approach is somewhat generic and could be used for any coinfection or cooccurence data in which the observed prevalence of events may not be predictive of the frequency of the infecting entities.</p>
<hr>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Let’s assume we have some data about occurence of <em>Plasmodium falciparum</em>, <em>malariae</em> and <em>vivax</em> as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"pf"</span> =<span class="st"> </span><span class="dv">902</span>, <span class="st">"pm"</span> =<span class="st"> </span><span class="dv">200</span>, <span class="st">"pv"</span> =<span class="st"> </span><span class="dv">44</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">          <span class="st">"pf/pm"</span> =<span class="st"> </span><span class="dv">9</span>, <span class="st">"pf/pv"</span> =<span class="st"> </span><span class="dv">29</span>, <span class="st">"pm/pv"</span> =<span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb1-3" data-line-number="3">          <span class="st">"pf/pm/pv"</span> =<span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p>We can test to see if any of the coinfection types occur more or less than best explained by the data and the independence model.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(icer)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; Registered S3 methods overwritten by 'ggplot2':</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;   method         from </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;   [.quosures     rlang</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;   c.quosures     rlang</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;   print.quosures rlang</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">res &lt;-<span class="st"> </span><span class="kw"><a href="reference/cooccurence_test.html">cooccurence_test</a></span>(data)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; iter   10 value 38.971224</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; final  value 38.971219 </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; converged</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; No id variables; using all as measure variables</span></a></code></pre></div>
<p><img src="https://i.imgur.com/6u9gnZA.png" width="700"></p>
<p>The resultant plot suggests that independent infection events do not perfectly explain this data, with the predicted number of pf/pm being too high, with the boostrapped estimates from the best fitting model notincluding the observed data well (5%-95% quantile in blue, median in white and observed data in red).</p>
<p>We can then change what type of model we use to describe the acquisition of species. For example maybe there is some interference between falciparum and malariae and the inverse for falciparu and vivax. We can specify starting values for how the probability of acquiring an additional strains depends of the first strain acquired. e.g. <code>k_12</code> is the multiplication of the probability of the next infection being <code>pm</code> given the first infection was <code>pf</code> and vice versa, i.e. next infection being <code>pf</code> given the first infection was <code>pm</code>. (The numbers refer to the species by alphabetic order):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">res_interf &lt;-<span class="st"> </span><span class="kw"><a href="reference/cooccurence_test.html">cooccurence_test</a></span>(data, <span class="dt">density_func =</span> icer<span class="op">:::</span>interference, </a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                               <span class="dt">k_12 =</span> <span class="fl">0.5</span>, <span class="dt">k_13 =</span> <span class="dv">2</span>, <span class="dt">k_23 =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; iter   10 value 15.580477</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; iter   20 value 13.643069</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; iter   30 value 13.516104</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; iter   40 value 13.188206</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; iter   50 value 13.092270</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; final  value 13.082618 </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; converged</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; No id variables; using all as measure variables</span></a></code></pre></div>
<p><img src="https://i.imgur.com/n0mgt3h.png" width="700"></p>
<p>That’s a lot better! We can see what the best estimate of the frequencies of each species, the mean number of infections (different to number of different species, i.e. you could have 6 infections but be Pf/Pv if you have 4 Pf infections and 2 Pv infections), and the values for the interference.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">res_interf<span class="op">$</span>params</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; $params</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;           pf           pm           pv           mu         size </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; 7.657616e-01 1.755459e-01 5.869248e-02 1.726855e+00 1.000043e+02 </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;         k_12         k_13         k_23 </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 7.764434e-03 5.867866e-02 1.000000e-02 </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; $multinom</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;           pf           pm           pv        pf/pm        pf/pv </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 0.7604943863 0.1687349573 0.0367985499 0.0076748673 0.0245925814 </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;        pm/pv     pf/pm/pv </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 0.0012177302 0.0004869276</span></a></code></pre></div>
<hr>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>OJ Watson <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP – Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://travis-ci.org/ojwatson/icer"><img src="https://travis-ci.org/ojwatson/icer.png?branch=master" alt="Travis-CI Build Status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by OJ Watson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
